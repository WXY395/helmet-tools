<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ä¾›æ‡‰å•†ç®¡ç†ç³»çµ±</title>
<style>
* { box-sizing: border-box; }
body { 
  font-family: "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif;
  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
  margin: 0;
  padding: 20px;
}
.container {
  max-width: 1400px;
  margin: 0 auto;
  background: white;
  padding: 2em;
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2em;
  padding-bottom: 1em;
  border-bottom: 3px solid #4facfe;
  flex-wrap: wrap;
  gap: 1em;
}
h2 { color: #2c3e50; margin: 0; }
.supplier-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 1.5em;
  margin-bottom: 2em;
}
.supplier-card {
  background: white;
  border-radius: 15px;
  padding: 1.5em;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  border-left: 5px solid #4facfe;
  transition: all 0.3s;
}
.supplier-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 25px rgba(0,0,0,0.15);
}
.supplier-card.best {
  border-left-color: #27ae60;
  background: linear-gradient(135deg, #d4edda 0%, #ffffff 100%);
}
.supplier-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1em;
}
.supplier-name {
  font-size: 1.3em;
  font-weight: bold;
  color: #2c3e50;
}
.best-badge {
  background: linear-gradient(135deg, #27ae60, #2ecc71);
  color: white;
  padding: 4px 12px;
  border-radius: 15px;
  font-size: 0.85em;
  font-weight: bold;
}
.rating {
  display: flex;
  gap: 0.3em;
  margin: 0.5em 0;
}
.star {
  color: #f39c12;
  font-size: 1.2em;
}
.supplier-info {
  margin: 0.8em 0;
  padding: 0.8em;
  background: #f8f9fa;
  border-radius: 8px;
}
.info-row {
  display: flex;
  justify-content: space-between;
  margin: 0.5em 0;
  font-size: 0.95em;
}
.info-label {
  color: #7f8c8d;
  font-weight: 500;
}
.info-value {
  color: #2c3e50;
  font-weight: bold;
}
.product-list {
  margin-top: 1em;
  padding-top: 1em;
  border-top: 1px solid #dee2e6;
}
.product-item {
  display: flex;
  justify-content: space-between;
  padding: 0.5em;
  background: #fff;
  border-radius: 6px;
  margin: 0.3em 0;
  border-left: 3px solid #4facfe;
}
.product-name {
  color: #2c3e50;
  font-weight: 500;
}
.product-price {
  color: #27ae60;
  font-weight: bold;
}
.supplier-actions {
  display: flex;
  gap: 0.5em;
  margin-top: 1em;
  flex-wrap: wrap;
}
button {
  background: #4facfe;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 0.9em;
}
button:hover {
  transform: translateY(-2px);
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}
button.success { background: #27ae60; }
button.warning { background: #f39c12; }
button.danger { background: #e74c3c; }
button.info { background: #3498db; }
.comparison-section {
  background: #f8f9fa;
  padding: 1.5em;
  border-radius: 15px;
  margin-bottom: 2em;
}
.comparison-table {
  width: 100%;
  border-collapse: collapse;
  background: white;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
.comparison-table th {
  background: linear-gradient(135deg, #4facfe, #00f2fe);
  color: white;
  padding: 12px;
  text-align: left;
  font-weight: 600;
}
.comparison-table td {
  padding: 12px;
  border-bottom: 1px solid #dee2e6;
}
.comparison-table tr:hover {
  background: #f8f9fa;
}
.price-best {
  background: #d4edda;
  color: #155724;
  font-weight: bold;
  padding: 4px 8px;
  border-radius: 5px;
}
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  z-index: 1000;
  justify-content: center;
  align-items: center;
  overflow-y: auto;
}
.modal-content {
  background: white;
  padding: 2em;
  border-radius: 15px;
  max-width: 600px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto;
  margin: 2em;
}
input, select, textarea {
  width: 100%;
  padding: 10px;
  margin: 0.5em 0;
  border: 2px solid #ddd;
  border-radius: 8px;
  font-size: 1em;
  font-family: inherit;
}
input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: #4facfe;
}
.quick-add {
  position: fixed;
  bottom: 30px;
  right: 30px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: linear-gradient(135deg, #4facfe, #00f2fe);
  color: white;
  font-size: 2em;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  cursor: pointer;
  transition: all 0.3s;
  z-index: 100;
}
.quick-add:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 30px rgba(0,0,0,0.4);
}
@media (max-width: 768px) {
  .container { padding: 1em; }
  .supplier-grid { grid-template-columns: 1fr; }
}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h2>ğŸ¢ ä¾›æ‡‰å•†ç®¡ç†ç³»çµ±</h2>
    <div style="display: flex; gap: 0.5em; flex-wrap: wrap;">
      <button onclick="showComparison()" class="info">ğŸ“Š åƒ¹æ ¼æ¯”è¼ƒ</button>
      <button onclick="exportSuppliers()" class="warning">ğŸ“„ åŒ¯å‡ºè³‡æ–™</button>
      <button onclick="window.location.href='index.html'">ğŸ  è¿”å›é¦–é </button>
    </div>
  </div>

  <div id="suppliersList">
    <div style="text-align: center; color: #7f8c8d; padding: 3em;">
      <div style="font-size: 3em; margin-bottom: 0.5em;">ğŸ¢</div>
      ç›®å‰æ²’æœ‰ä¾›æ‡‰å•†è³‡æ–™<br>é»æ“Šå³ä¸‹è§’ã€Œâ•ã€æ–°å¢ç¬¬ä¸€å€‹ä¾›æ‡‰å•†
    </div>
  </div>

  <div id="comparisonSection" style="display: none;" class="comparison-section">
    <h3 style="color: #2c3e50; margin-top: 0;">ğŸ“Š åŒå•†å“åƒ¹æ ¼æ¯”è¼ƒ</h3>
    <div id="comparisonContent"></div>
  </div>
</div>

<div class="quick-add" onclick="showAddSupplier()" title="æ–°å¢ä¾›æ‡‰å•†">â•</div>

<!-- æ–°å¢ä¾›æ‡‰å•† Modal -->
<div id="supplierModal" class="modal">
  <div class="modal-content">
    <h3 id="modalTitle">æ–°å¢ä¾›æ‡‰å•†</h3>
    <input type="hidden" id="supplierId">
    
    <label>ä¾›æ‡‰å•†åç¨±ï¼š</label>
    <input type="text" id="supplierName" placeholder="ä¾‹å¦‚ï¼šXXè²¿æ˜“å…¬å¸">
    
    <label>è¯çµ¡äººï¼š</label>
    <input type="text" id="contactPerson" placeholder="ä¾‹å¦‚ï¼šç‹ç¶“ç†">
    
    <label>è¯çµ¡é›»è©±ï¼š</label>
    <input type="tel" id="contactPhone" placeholder="ä¾‹å¦‚ï¼š0912-345-678">
    
    <label>é›»å­ä¿¡ç®±ï¼š</label>
    <input type="email" id="contactEmail" placeholder="é¸å¡«">
    
    <label>åœ°å€ï¼š</label>
    <textarea id="supplierAddress" rows="2" placeholder="é¸å¡«"></textarea>
    
    <label>ä»˜æ¬¾æ¢ä»¶ï¼š</label>
    <select id="paymentTerms">
      <option value="è²¨åˆ°ä»˜æ¬¾">è²¨åˆ°ä»˜æ¬¾</option>
      <option value="æœˆçµ30å¤©">æœˆçµ30å¤©</option>
      <option value="æœˆçµ60å¤©">æœˆçµ60å¤©</option>
      <option value="é ä»˜æ¬¾">é ä»˜æ¬¾</option>
      <option value="å…¶ä»–">å…¶ä»–</option>
    </select>
    
    <label>æœ€ä½è¨‚è³¼é‡ï¼š</label>
    <input type="number" id="minOrder" value="1" min="1">
    
    <label>è©•åˆ†ï¼ˆ1-5æ˜Ÿï¼‰ï¼š</label>
    <select id="supplierRating">
      <option value="5">â­â­â­â­â­ éå¸¸å¥½</option>
      <option value="4">â­â­â­â­ å¾ˆå¥½</option>
      <option value="3" selected>â­â­â­ æ™®é€š</option>
      <option value="2">â­â­ ä¸å¤ªå¥½</option>
      <option value="1">â­ å·®</option>
    </select>
    
    <label>å‚™è¨»ï¼š</label>
    <textarea id="supplierNotes" rows="2" placeholder="ä¾‹å¦‚ï¼šå“è³ªç©©å®šã€äº¤è²¨æº–æ™‚"></textarea>
    
    <div style="margin-top: 1.5em; display: flex; gap: 1em;">
      <button onclick="saveSupplier()" class="success">ğŸ’¾ ä¿å­˜</button>
      <button onclick="closeModal()">å–æ¶ˆ</button>
    </div>
  </div>
</div>

<!-- æ–°å¢å•†å“å ±åƒ¹ Modal -->
<div id="productModal" class="modal">
  <div class="modal-content">
    <h3>æ–°å¢å•†å“å ±åƒ¹</h3>
    <input type="hidden" id="productSupplierId">
    
    <label>å•†å“åç¨±/å‹è™Ÿï¼š</label>
    <input type="text" id="productName" placeholder="ä¾‹å¦‚ï¼šEVO å…¨ç½©å®‰å…¨å¸½">
    
    <label>é€²è²¨å–®åƒ¹ï¼ˆå…ƒï¼‰ï¼š</label>
    <input type="number" id="productPrice" value="0" min="0" step="0.1">
    
    <label>å ±åƒ¹æ—¥æœŸï¼š</label>
    <input type="date" id="quoteDate">
    
    <label>å‚™è¨»ï¼š</label>
    <input type="text" id="productNote" placeholder="é¸å¡«">
    
    <div style="margin-top: 1.5em; display: flex; gap: 1em;">
      <button onclick="saveProduct()" class="success">ğŸ’¾ ä¿å­˜</button>
      <button onclick="closeModal()">å–æ¶ˆ</button>
    </div>
  </div>
</div>

<script>
let suppliers = [];

window.onload = function() {
  loadSuppliers();
  renderSuppliers();
  document.getElementById('quoteDate').valueAsDate = new Date();
};

function loadSuppliers() {
  try {
    if (window.suppliersFullData) {
      suppliers = window.suppliersFullData;
    }
  } catch(e) {
    console.log('è¼‰å…¥ä¾›æ‡‰å•†è³‡æ–™å¤±æ•—');
  }
}

function saveSuppliers() {
  try {
    window.suppliersFullData = suppliers;
  } catch(e) {
    console.log('ä¿å­˜ä¾›æ‡‰å•†è³‡æ–™å¤±æ•—');
  }
}

function showAddSupplier() {
  document.getElementById('modalTitle').textContent = 'æ–°å¢ä¾›æ‡‰å•†';
  document.getElementById('supplierId').value = '';
  document.getElementById('supplierName').value = '';
  document.getElementById('contactPerson').value = '';
  document.getElementById('contactPhone').value = '';
  document.getElementById('contactEmail').value = '';
  document.getElementById('supplierAddress').value = '';
  document.getElementById('paymentTerms').value = 'è²¨åˆ°ä»˜æ¬¾';
  document.getElementById('minOrder').value = '1';
  document.getElementById('supplierRating').value = '3';
  document.getElementById('supplierNotes').value = '';
  document.getElementById('supplierModal').style.display = 'flex';
}

function saveSupplier() {
  let id = document.getElementById('supplierId').value;
  let name = document.getElementById('supplierName').value.trim();
  
  if (!name) {
    alert('è«‹è¼¸å…¥ä¾›æ‡‰å•†åç¨±ï¼');
    return;
  }
  
  let supplier = {
    id: id || Date.now().toString(),
    name: name,
    contactPerson: document.getElementById('contactPerson').value.trim(),
    contactPhone: document.getElementById('contactPhone').value.trim(),
    contactEmail: document.getElementById('contactEmail').value.trim(),
    address: document.getElementById('supplierAddress').value.trim(),
    paymentTerms: document.getElementById('paymentTerms').value,
    minOrder: parseInt(document.getElementById('minOrder').value) || 1,
    rating: parseInt(document.getElementById('supplierRating').value) || 3,
    notes: document.getElementById('supplierNotes').value.trim(),
    products: id ? suppliers.find(s => s.id === id).products : [],
    createdAt: id ? suppliers.find(s => s.id === id).createdAt : new Date().toISOString()
  };
  
  if (id) {
    let index = suppliers.findIndex(s => s.id === id);
    suppliers[index] = supplier;
  } else {
    suppliers.push(supplier);
  }
  
  saveSuppliers();
  renderSuppliers();
  closeModal();
  alert('âœ… ä¾›æ‡‰å•†è³‡æ–™å·²ä¿å­˜ï¼');
}

function editSupplier(id) {
  let supplier = suppliers.find(s => s.id === id);
  if (!supplier) return;
  
  document.getElementById('modalTitle').textContent = 'ç·¨è¼¯ä¾›æ‡‰å•†';
  document.getElementById('supplierId').value = supplier.id;
  document.getElementById('supplierName').value = supplier.name;
  document.getElementById('contactPerson').value = supplier.contactPerson;
  document.getElementById('contactPhone').value = supplier.contactPhone;
  document.getElementById('contactEmail').value = supplier.contactEmail;
  document.getElementById('supplierAddress').value = supplier.address;
  document.getElementById('paymentTerms').value = supplier.paymentTerms;
  document.getElementById('minOrder').value = supplier.minOrder;
  document.getElementById('supplierRating').value = supplier.rating;
  document.getElementById('supplierNotes').value = supplier.notes;
  document.getElementById('supplierModal').style.display = 'flex';
}

function deleteSupplier(id) {
  let supplier = suppliers.find(s => s.id === id);
  if (!supplier) return;
  
  if (confirm(`ç¢ºå®šè¦åˆªé™¤ä¾›æ‡‰å•†ã€Œ${supplier.name}ã€å—ï¼Ÿ\n\næ­¤æ“ä½œæœƒåŒæ™‚åˆªé™¤è©²ä¾›æ‡‰å•†çš„æ‰€æœ‰å•†å“å ±åƒ¹ï¼Œç„¡æ³•å¾©åŸï¼`)) {
    suppliers = suppliers.filter(s => s.id !== id);
    saveSuppliers();
    renderSuppliers();
    alert('âœ… ä¾›æ‡‰å•†å·²åˆªé™¤');
  }
}

function showAddProduct(supplierId) {
  document.getElementById('productSupplierId').value = supplierId;
  document.getElementById('productName').value = '';
  document.getElementById('productPrice').value = '0';
  document.getElementById('quoteDate').valueAsDate = new Date();
  document.getElementById('productNote').value = '';
  document.getElementById('productModal').style.display = 'flex';
}

function saveProduct() {
  let supplierId = document.getElementById('productSupplierId').value;
  let supplier = suppliers.find(s => s.id === supplierId);
  if (!supplier) return;
  
  let productName = document.getElementById('productName').value.trim();
  let productPrice = parseFloat(document.getElementById('productPrice').value) || 0;
  
  if (!productName) {
    alert('è«‹è¼¸å…¥å•†å“åç¨±ï¼');
    return;
  }
  
  if (productPrice <= 0) {
    alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„åƒ¹æ ¼ï¼');
    return;
  }
  
  if (!supplier.products) {
    supplier.products = [];
  }
  
  supplier.products.push({
    id: Date.now().toString(),
    name: productName,
    price: productPrice,
    quoteDate: document.getElementById('quoteDate').value,
    note: document.getElementById('productNote').value.trim()
  });
  
  saveSuppliers();
  renderSuppliers();
  closeModal();
  alert('âœ… å•†å“å ±åƒ¹å·²æ–°å¢ï¼');
}

function deleteProduct(supplierId, productId) {
  let supplier = suppliers.find(s => s.id === supplierId);
  if (!supplier) return;
  
  if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹å•†å“å ±åƒ¹å—ï¼Ÿ')) {
    supplier.products = supplier.products.filter(p => p.id !== productId);
    saveSuppliers();
    renderSuppliers();
    alert('âœ… å•†å“å ±åƒ¹å·²åˆªé™¤');
  }
}

function renderSuppliers() {
  if (suppliers.length === 0) {
    document.getElementById('suppliersList').innerHTML = `
      <div style="text-align: center; color: #7f8c8d; padding: 3em;">
        <div style="font-size: 3em; margin-bottom: 0.5em;">ğŸ¢</div>
        ç›®å‰æ²’æœ‰ä¾›æ‡‰å•†è³‡æ–™<br>é»æ“Šå³ä¸‹è§’ã€Œâ•ã€æ–°å¢ç¬¬ä¸€å€‹ä¾›æ‡‰å•†
      </div>
    `;
    return;
  }
  
  // æ‰¾å‡ºæ¯å€‹å•†å“çš„æœ€ä½åƒ¹ä¾›æ‡‰å•†
  let productPrices = {};
  suppliers.forEach(supplier => {
    if (supplier.products) {
      supplier.products.forEach(product => {
        if (!productPrices[product.name] || product.price < productPrices[product.name].price) {
          productPrices[product.name] = {
            price: product.price,
            supplierId: supplier.id
          };
        }
      });
    }
  });
  
  let html = '<div class="supplier-grid">';
  
  suppliers.forEach(supplier => {
    let isBest = false;
    let bestCount = 0;
    
    if (supplier.products) {
      supplier.products.forEach(product => {
        if (productPrices[product.name] && productPrices[product.name].supplierId === supplier.id) {
          bestCount++;
        }
      });
      if (bestCount > 0 && supplier.products.length > 0) {
        isBest = true;
      }
    }
    
    let stars = '';
    for (let i = 0; i < 5; i++) {
      stars += i < supplier.rating ? '<span class="star">â­</span>' : '<span class="star" style="opacity:0.3">â­</span>';
    }
    
    let productsHtml = '';
    if (supplier.products && supplier.products.length > 0) {
      productsHtml = '<div class="product-list"><strong style="color: #2c3e50;">å•†å“å ±åƒ¹ï¼š</strong>';
      supplier.products.forEach(product => {
        let isCheapest = productPrices[product.name] && productPrices[product.name].supplierId === supplier.id;
        productsHtml += `
          <div class="product-item" ${isCheapest ? 'style="border-left-color: #27ae60; background: #d4edda;"' : ''}>
            <span class="product-name">${product.name} ${isCheapest ? 'ğŸ†' : ''}</span>
            <div>
              <span class="product-price">$${product.price}</span>
              <button onclick="deleteProduct('${supplier.id}', '${product.id}')" class="danger" style="padding: 2px 6px; font-size: 0.8em; margin-left: 0.5em;">ğŸ—‘ï¸</button>
            </div>
          </div>
        `;
      });
      productsHtml += '</div>';
    }
    
    html += `
      <div class="supplier-card ${isBest ? 'best' : ''}">
        <div class="supplier-header">
          <div class="supplier-name">${supplier.name}</div>
          ${isBest ? `<span class="best-badge">ğŸ† æœ€ä½³ ${bestCount} é …</span>` : ''}
        </div>
        
        <div class="rating">${stars}</div>
        
        <div class="supplier-info">
          ${supplier.contactPerson ? `<div class="info-row"><span class="info-label">è¯çµ¡äººï¼š</span><span class="info-value">${supplier.contactPerson}</span></div>` : ''}
          ${supplier.contactPhone ? `<div class="info-row"><span class="info-label">é›»è©±ï¼š</span><span class="info-value">${supplier.contactPhone}</span></div>` : ''}
          <div class="info-row"><span class="info-label">ä»˜æ¬¾æ¢ä»¶ï¼š</span><span class="info-value">${supplier.paymentTerms}</span></div>
          <div class="info-row"><span class="info-label">æœ€ä½è¨‚è³¼ï¼š</span><span class="info-value">${supplier.minOrder} ä»¶</span></div>
        </div>
        
        ${supplier.notes ? `<div style="margin-top: 0.8em; padding: 0.8em; background: #fff3cd; border-radius: 6px; font-size: 0.9em; color: #856404;">ğŸ’¡ ${supplier.notes}</div>` : ''}
        
        ${productsHtml}
        
        <div class="supplier-actions">
          <button onclick="showAddProduct('${supplier.id}')" class="success">â• æ–°å¢å ±åƒ¹</button>
          <button onclick="editSupplier('${supplier.id}')" class="warning">âœï¸ ç·¨è¼¯</button>
          <button onclick="deleteSupplier('${supplier.id}')" class="danger">ğŸ—‘ï¸ åˆªé™¤</button>
        </div>
      </div>
    `;
  });
  
  html += '</div>';
  document.getElementById('suppliersList').innerHTML = html;
}

function showComparison() {
  let productMap = {};
  
  suppliers.forEach(supplier => {
    if (supplier.products) {
      supplier.products.forEach(product => {
        if (!productMap[product.name]) {
          productMap[product.name] = [];
        }
        productMap[product.name].push({
          supplier: supplier.name,
          price: product.price,
          quoteDate: product.quoteDate,
          note: product.note
        });
      });
    }
  });
  
  if (Object.keys(productMap).length === 0) {
    alert('ç›®å‰æ²’æœ‰å•†å“å ±åƒ¹å¯ä»¥æ¯”è¼ƒï¼');
    return;
  }
  
  let html = '';
  
  for (let productName in productMap) {
    let quotes = productMap[productName];
    quotes.sort((a, b) => a.price - b.price);
    let minPrice = quotes[0].price;
    
    html += `
      <h4 style="color: #2c3e50; margin-top: 1.5em;">${productName}</h4>
      <table class="comparison-table">
        <thead>
          <tr>
            <th>ä¾›æ‡‰å•†</th>
            <th>å ±åƒ¹</th>
            <th>å ±åƒ¹æ—¥æœŸ</th>
            <th>å‚™è¨»</th>
          </tr>
        </thead>
        <tbody>
    `;
    
    quotes.forEach(quote => {
      html += `
        <tr>
          <td><strong>${quote.supplier}</strong></td>
          <td><span class="${quote.price === minPrice ? 'price-best' : ''}" style="font-size: 1.1em;">$${quote.price}</span> ${quote.price === minPrice ? 'ğŸ†' : ''}</td>
          <td>${quote.quoteDate}</td>
          <td style="color: #7f8c8d;">${quote.note || '-'}</td>
        </tr>
      `;
    });
    
    html += '</tbody></table>';
  }
  
  document.getElementById('comparisonContent').innerHTML = html;
  document.getElementById('comparisonSection').style.display = 'block';
  document.getElementById('comparisonSection').scrollIntoView({ behavior: 'smooth' });
}

function exportSuppliers() {
  if (suppliers.length === 0) {
    alert('ç›®å‰æ²’æœ‰ä¾›æ‡‰å•†è³‡æ–™å¯ä»¥åŒ¯å‡ºï¼');
    return;
  }
  
  let csv = 'ä¾›æ‡‰å•†åç¨±,è¯çµ¡äºº,è¯çµ¡é›»è©±,é›»å­ä¿¡ç®±,åœ°å€,ä»˜æ¬¾æ¢ä»¶,æœ€ä½è¨‚è³¼é‡,è©•åˆ†,å‚™è¨»\n';
  
  suppliers.forEach(supplier => {
    csv += `"${supplier.name}","${supplier.contactPerson}","${supplier.contactPhone}","${supplier.contactEmail}","${supplier.address}","${supplier.paymentTerms}",${supplier.minOrder},${supplier.rating},"${supplier.notes}"\n`;
  });
  
  let blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
  let link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'ä¾›æ‡‰å•†è³‡æ–™_' + new Date().toLocaleDateString('zh-TW') + '.csv';
  link.click();
  
  alert('âœ… ä¾›æ‡‰å•†è³‡æ–™å·²åŒ¯å‡ºï¼');
}

function closeModal() {
  document.getElementById('supplierModal').style.display = 'none';
  document.getElementById('productModal').style.display = 'none';
}

document.querySelectorAll('.modal').forEach(modal => {
  modal.addEventListener('click', function(e) {
    if (e.target === this) {
      closeModal();
    }
  });
});
</script>
</body>
</html>
